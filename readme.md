Copy of simc by Werner Boeglin.
